<!-- ═══════════════════════════════════════════════════════════════ -->
<!-- HISTORIQUE DU JOUR — BIOSEN100 PREMIUM DESIGN                  -->
<!-- ═══════════════════════════════════════════════════════════════ -->

<div class="space-y-5 pb-10">

  <!-- ── EN-TÊTE ───────────────────────────────────────────────── -->
  <div class="flex items-center gap-4">
    <div class="flex items-center gap-3">
      <a routerLink="/commandes"
         class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0
                transition-all duration-200 hover:bg-[#15803D]/8 active:scale-95"
         style="background: rgba(21,128,61,0.06); color: #15803D;">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
        </svg>
      </a>
      <div>
        <h1 class="text-2xl font-black text-gray-800 tracking-tight">Commandes du jour</h1>
        <p class="text-sm text-gray-400 mt-0.5">Résumé et détails d'aujourd'hui</p>
      </div>
    </div>
  </div>

  <!-- ── CARTES RÉSUMÉ ─────────────────────────────────────────── -->
  @if (resume && !loading) {
    <div class="grid grid-cols-2 sm:grid-cols-3 xl:grid-cols-5 gap-3">

      <!-- Total commandes -->
      <div class="bg-[#f7faf7] rounded-2xl border border-[#15803D]/6 px-4 py-4"
           style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0"
               style="background: rgba(59,130,246,0.08);">
            <svg class="w-5 h-5 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
          </div>
          <div>
            <p class="text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Commandes</p>
            <p class="text-xl font-black text-gray-800 mt-0.5">{{ resume.total_commandes }}</p>
          </div>
        </div>
      </div>

      <!-- Somme totale -->
      <div class="bg-[#f7faf7] rounded-2xl border border-[#15803D]/6 px-4 py-4"
           style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0"
               style="background: rgba(21,128,61,0.08);">
            <svg class="w-5 h-5 text-[#15803D]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <div>
            <p class="text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Total</p>
            <p class="text-lg font-black text-[#15803D] mt-0.5">{{ resume.somme_totale | number:'1.0-0' }} <span class="text-xs">F</span></p>
          </div>
        </div>
      </div>

      <!-- Validées -->
      <div class="bg-[#f7faf7] rounded-2xl border border-[#15803D]/6 px-4 py-4"
           style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0"
               style="background: rgba(21,128,61,0.08);">
            <svg class="w-5 h-5 text-[#15803D]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <div>
            <p class="text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Validées</p>
            <p class="text-lg font-black text-[#15803D] mt-0.5">{{ resume.total_validees | number:'1.0-0' }} <span class="text-xs">F</span></p>
          </div>
        </div>
      </div>

      <!-- En cours -->
      <div class="bg-[#f7faf7] rounded-2xl border border-[#15803D]/6 px-4 py-4"
           style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0"
               style="background: rgba(245,158,11,0.08);">
            <svg class="w-5 h-5 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <div>
            <p class="text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">En cours</p>
            <p class="text-xl font-black text-amber-600 mt-0.5">{{ resume.nb_en_cours }}</p>
          </div>
        </div>
      </div>

      <!-- Annulées -->
      <div class="bg-[#f7faf7] rounded-2xl border border-[#15803D]/6 px-4 py-4 col-span-2 sm:col-span-1"
           style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0"
               style="background: rgba(239,68,68,0.08);">
            <svg class="w-5 h-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <div>
            <p class="text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Annulées</p>
            <p class="text-xl font-black text-red-500 mt-0.5">{{ resume.nb_annulees }}</p>
          </div>
        </div>
      </div>

    </div>
  }

  <!-- ── LISTE DES COMMANDES ───────────────────────────────────── -->
  <section class="bg-[#f7faf7] rounded-2xl border border-[#15803D]/6 overflow-hidden"
           style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">

    <!-- Header -->
    <div class="px-5 sm:px-6 py-4 border-b border-[#15803D]/5 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-xl flex items-center justify-center"
             style="background: rgba(21,128,61,0.08);">
          <svg class="w-[18px] h-[18px] text-[#15803D]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-black text-gray-800">Commandes</h2>
          <p class="text-[11px] text-gray-400 mt-0.5">
            @if (!loading && commandes.length > 0) {
              {{ commandes.length }} résultat(s)
            } @else {
              Détail des commandes du jour
            }
          </p>
        </div>
      </div>
    </div>

    <!-- Contenu -->
    @if (loading) {
      <div class="flex flex-col items-center justify-center py-16 gap-3">
        <div class="w-10 h-10 rounded-full border-[3px] border-[#15803D] border-t-transparent animate-spin"></div>
        <p class="text-xs text-gray-400 font-medium">Chargement…</p>
      </div>
    } @else if (commandes.length === 0) {
      <div class="flex flex-col items-center justify-center py-16 text-center px-6">
        <div class="w-14 h-14 rounded-2xl flex items-center justify-center mb-3"
             style="background: rgba(21,128,61,0.06);">
          <svg class="w-7 h-7 text-[#15803D]/25" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
        </div>
        <p class="text-sm font-bold text-gray-400 mb-1">Aucune commande</p>
        <p class="text-[11px] text-gray-300">Aucune commande trouvée pour cette date</p>
      </div>
    } @else {
      <!-- DESKTOP TABLE -->
      <div class="hidden sm:block overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b border-[#15803D]/5">
              <th class="px-5 py-3 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">N° Commande</th>
              <th class="px-5 py-3 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Client</th>
              <th class="px-5 py-3 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Type</th>
              <th class="px-5 py-3 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Statut</th>
              <th class="px-5 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Total</th>
              <th class="px-5 py-3 text-center text-[10px] font-black text-gray-400 uppercase tracking-[0.1em]">Heure</th>
              <th class="px-5 py-3 w-16"></th>
            </tr>
          </thead>
          <tbody>
            @for (commande of commandes; track trackByCommandeId($index, commande)) {
              <tr class="border-b border-[#15803D]/4 last:border-0 hover:bg-white/60 transition-colors duration-150 group">
                <td class="px-5 py-3.5">
                  <p class="text-sm font-bold text-gray-800">{{ commande.numero_commande }}</p>
                  @if (commande.employe) {
                    <p class="text-[11px] text-gray-400 mt-0.5">{{ commande.employe.nom }}</p>
                  }
                </td>
                <td class="px-5 py-3.5">
                  @if (commande.client) {
                    <p class="text-sm font-bold text-gray-800">{{ commande.client.nom_complet }}</p>
                    <p class="text-[11px] text-gray-400 mt-0.5">{{ commande.client.telephone }}</p>
                  } @else {
                    <span class="text-[11px] text-gray-300 italic">Sans client</span>
                  }
                </td>
                <td class="px-5 py-3.5">
                  @if (commande.type_commande === 'livraison') {
                    <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-[10px] font-black"
                          style="background: rgba(251,146,60,0.10); color: #ea580c;">
                      <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"/>
                      </svg>
                      Livraison
                    </span>
                  } @else {
                    <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-[10px] font-black"
                          style="background: rgba(21,128,61,0.06); color: #15803D;">
                      <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                      </svg>
                      Sur place
                    </span>
                  }
                </td>
                <td class="px-5 py-3.5">
                  <span [class]="getStatutClass(commande.statut)"
                        class="inline-block px-2.5 py-1 rounded-lg text-[10px] font-black">
                    {{ getStatutLabel(commande.statut) }}
                  </span>
                </td>
                <td class="px-5 py-3.5 text-right">
                  <p class="text-sm font-black text-gray-800">{{ commande.total | number:'1.0-0' }} F</p>
                </td>
                <td class="px-5 py-3.5 text-center">
                  <span class="text-xs text-gray-400 font-bold">{{ commande.created_at | date:'HH:mm' }}</span>
                </td>
                <td class="px-5 py-3.5">
                  <a [routerLink]="['/commandes', commande.id]"
                     class="w-8 h-8 rounded-lg flex items-center justify-center
                            text-gray-300 hover:text-[#15803D] hover:bg-[#15803D]/6
                            transition-all duration-200 active:scale-90">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
                    </svg>
                  </a>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>

      <!-- MOBILE CARDS -->
      <div class="sm:hidden px-4 py-3 space-y-2">
        @for (commande of commandes; track trackByCommandeId($index, commande)) {
          <a [routerLink]="['/commandes', commande.id]"
             class="block p-4 bg-white rounded-xl border border-[#15803D]/6
                    hover:border-[#15803D]/15 transition-all duration-200 active:scale-[0.98]"
             style="box-shadow: 0 1px 3px rgba(21,128,61,0.04);">
            <div class="flex items-center justify-between mb-2.5">
              <div class="flex items-center gap-2">
                <span class="text-sm font-black text-gray-800">{{ commande.numero_commande }}</span>
                <span [class]="getStatutClass(commande.statut)"
                      class="inline-block px-2 py-0.5 rounded-lg text-[9px] font-black">
                  {{ getStatutLabel(commande.statut) }}
                </span>
              </div>
              <span class="text-[11px] text-gray-400 font-bold">{{ commande.created_at | date:'HH:mm' }}</span>
            </div>
            <div class="flex items-center justify-between">
              <div class="min-w-0">
                @if (commande.client) {
                  <p class="text-xs text-gray-600 font-medium truncate">{{ commande.client.nom_complet }}</p>
                } @else {
                  <p class="text-xs text-gray-300 italic">Sans client</p>
                }
                <div class="flex items-center gap-2 mt-1">
                  @if (commande.type_commande === 'livraison') {
                    <span class="text-[10px] font-bold text-orange-500">Livraison</span>
                  } @else {
                    <span class="text-[10px] font-bold text-[#15803D]">Sur place</span>
                  }
                  @if (commande.employe) {
                    <span class="w-1 h-1 rounded-full bg-gray-300"></span>
                    <span class="text-[10px] text-gray-400">{{ commande.employe.nom }}</span>
                  }
                </div>
              </div>
              <div class="flex items-center gap-2 shrink-0">
                <p class="text-base font-black text-[#15803D]">{{ commande.total | number:'1.0-0' }} F</p>
                <svg class="w-4 h-4 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
                </svg>
              </div>
            </div>
          </a>
        }
      </div>
    }
  </section>

</div>
