<aside class="sidebar flex flex-col shrink-0 transition-all duration-300 overflow-hidden relative"
       [class.sidebar-open]="isOpen"
       [class.sidebar-closed]="!isOpen">

  <!-- ── Fond principal blanc avec texture subtile ── -->
  <div class="absolute inset-0 pointer-events-none" style="background: #ffffff; z-index: 0;"></div>
  <!-- Ligne décorative verte sur le bord droit -->
  <div class="absolute top-0 right-0 bottom-0 pointer-events-none"
       style="width: 1px; background: linear-gradient(180deg, #15803D 0%, rgba(21,128,61,0.08) 100%); z-index: 1;">
  </div>
  <!-- Glow subtil en haut -->
  <div class="absolute top-0 left-0 right-0 h-48 pointer-events-none"
       style="background: radial-gradient(ellipse at 30% -20%, rgba(21,128,61,0.06) 0%, transparent 70%); z-index: 0;">
  </div>

  <!-- ── LOGO ───────────────────────────────────────────────── -->
  <div class="relative z-10 flex items-center gap-4 px-6 whitespace-nowrap shrink-0"
       style="height: 72px; border-bottom: 1px solid rgba(21,128,61,0.08);">
    <!-- Icône logo -->
    <div class="w-11 h-11 rounded-2xl flex items-center justify-center shrink-0"
         style="background: linear-gradient(145deg, #15803D 0%, #1a9d4a 100%);
                box-shadow: 0 6px 20px rgba(21,128,61,0.35), 0 2px 6px rgba(21,128,61,0.20), inset 0 1px 0 rgba(255,255,255,0.18);">
      <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184
                 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
      </svg>
    </div>
    <div>
      <div class="font-black text-[19px] leading-none whitespace-nowrap"
           style="color: #15803D; letter-spacing: -0.03em;">
        Biosen100
      </div>
      <div class="text-[10px] font-bold mt-1.5 whitespace-nowrap uppercase tracking-[0.10em]"
           style="color: rgba(21,128,61,0.45);">
        Gestion commerciale
      </div>
    </div>
  </div>

  <!-- ── NAVIGATION ─────────────────────────────────────────── -->
  <nav class="relative z-10 flex-1 overflow-y-auto px-4 py-5 sidebar-scroll">
    <p class="px-3 pb-3 pt-1 text-[11px] font-black uppercase whitespace-nowrap"
       style="letter-spacing: 0.16em; color: rgba(21,128,61,0.32);">
      Menu principal
    </p>

    @for (item of navItems; track item.route) {
      <a [routerLink]="item.route"
         routerLinkActive="nav-active"
         #rla="routerLinkActive"
         [routerLinkActiveOptions]="{ exact: item.route === '/dashboard' }"
         class="nav-item group flex items-center gap-3.5 px-4 py-3.5 rounded-2xl mb-1
                transition-all duration-200 whitespace-nowrap relative overflow-hidden cursor-pointer"
         [class.nav-item-active]="rla.isActive">

        <!-- BG actif -->
        @if (rla.isActive) {
          <div class="absolute inset-0 rounded-2xl pointer-events-none"
               style="background: linear-gradient(135deg, #15803D 0%, #1a9d4a 100%);
                      box-shadow: 0 4px 16px rgba(21,128,61,0.30), 0 2px 6px rgba(21,128,61,0.15);">
          </div>
        }

        <!-- Icône -->
        <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0 transition-all duration-200 relative z-10"
             [style.background]="rla.isActive ? 'rgba(255,255,255,0.20)' : 'rgba(21,128,61,0.06)'"
             [style.color]="rla.isActive ? '#ffffff' : '#15803D'">

          @if (item.icon === 'dashboard') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
          }
          @if (item.icon === 'commandes') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
            </svg>
          }
          @if (item.icon === 'produits') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
            </svg>
          }
          @if (item.icon === 'categories') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
            </svg>
          }
          @if (item.icon === 'clients') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
          }
          @if (item.icon === 'employes') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
          }
          @if (item.icon === 'livreurs') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"/>
            </svg>
          }
          @if (item.icon === 'depenses') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/>
            </svg>
          }
          @if (item.icon === 'factures') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
          }
          @if (item.icon === 'boutiques') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
            </svg>
          }
          @if (item.icon === 'users') {
            <svg class="w-[19px] h-[19px]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
            </svg>
          }
        </div>

        <!-- Label -->
        <span class="text-[15px] font-semibold whitespace-nowrap relative z-10 transition-colors duration-200"
              [style.color]="rla.isActive ? '#ffffff' : '#374151'"
              [style.letter-spacing]="'-0.01em'">
          {{ item.label }}
        </span>

        <!-- Chevron / indicateur actif -->
        @if (rla.isActive) {
          <div class="ml-auto shrink-0 relative z-10">
            <svg class="w-4 h-4 text-white/70" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
            </svg>
          </div>
        }
      </a>
    }
  </nav>

  <!-- ── FOOTER ─────────────────────────────────────────────── -->
  <div class="relative z-10 px-6 py-5 shrink-0 whitespace-nowrap"
       style="border-top: 1px solid rgba(21,128,61,0.08);">
    <div class="flex items-center gap-2.5">
      <div class="w-2 h-2 rounded-full shrink-0 sidebar-pulse"
           style="background: #15803D; box-shadow: 0 0 8px rgba(21,128,61,0.50);">
      </div>
      <span class="text-[11px] font-semibold" style="color: rgba(21,128,61,0.30);">
        Biosen100 &copy; 2026
      </span>
    </div>
  </div>
</aside>

<style>
  /* ── Base ── */
  .sidebar {
    height: 100vh;
    min-height: 100vh;
    background: #ffffff;
    border-right: 1.5px solid rgba(21,128,61,0.10);
  }

  /* ── Largeur desktop ── */
  .sidebar-open  { width: 300px; }
  .sidebar-closed { width: 0; }

  /* ── Hover sur items non-actifs ── */
  .nav-item:not(.nav-item-active):hover {
    background: rgba(21,128,61,0.04) !important;
  }
  .nav-item:not(.nav-item-active):hover > div:first-of-type {
    background: rgba(21,128,61,0.10) !important;
  }
  .nav-item:not(.nav-item-active):hover span {
    color: #15803D !important;
  }

  /* ── Active item pressed effect ── */
  .nav-item-active:active {
    transform: scale(0.985);
  }

  /* ── Scrollbar custom ── */
  .sidebar-scroll {
    scrollbar-width: thin;
    scrollbar-color: rgba(21,128,61,0.12) transparent;
  }
  .sidebar-scroll::-webkit-scrollbar { width: 4px; }
  .sidebar-scroll::-webkit-scrollbar-track { background: transparent; }
  .sidebar-scroll::-webkit-scrollbar-thumb {
    background: rgba(21,128,61,0.12);
    border-radius: 10px;
  }
  .sidebar-scroll::-webkit-scrollbar-thumb:hover {
    background: rgba(21,128,61,0.25);
  }

  /* ── Pulse animation ── */
  @keyframes sidebarPulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50%      { opacity: 0.40; transform: scale(0.80); }
  }
  .sidebar-pulse { animation: sidebarPulse 2.5s ease-in-out infinite; }

  /* ── RESPONSIVE : Tablette ── */
  @media (max-width: 1024px) {
    .sidebar-open { width: 280px; }
  }

  /* ── RESPONSIVE : Mobile ── */
  @media (max-width: 768px) {
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 50;
      box-shadow: 8px 0 30px rgba(0,0,0,0.15);
    }
    .sidebar-open  { width: 290px; }
    .sidebar-closed { width: 0; box-shadow: none; }
  }
</style>
